from airflow.models import Variable

# Get the variable and deserialize it to a Python dictionary
my_json = Variable.get("my_json_variable", deserialize_json=True)

# Use the JSON data in your task
def process_json(**kwargs):
    # Example: Accessing values from the JSON
    value1 = my_json.get("key1")
    value2 = my_json.get("key2")
    print(f"Key1: {value1}, Key2: {value2}")

# Define your DAG
from airflow import DAG
from airflow.operators.python_operator import PythonOperator
from datetime import datetime

default_args = {
    'start_date': datetime(2024, 1, 1),
}

with DAG('example_json_dag', default_args=default_args, schedule_interval='@daily') as dag:
    
    process_task = PythonOperator(
        task_id='process_json_task',
        python_callable=process_json,
        provide_context=True,
    )
