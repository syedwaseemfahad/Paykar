def remove_cy_cn_duplicates(data):
    rows_by_attributes = {}
    to_remove = set()

    for index, row in enumerate(data):
        key = (row[0], row[1], row[2], row[4])

        if key in rows_by_attributes:
            prev_index = rows_by_attributes[key]
            if {row[3], data[prev_index][3]} == {'CY', 'CN'}:
                to_remove.add(index)
                to_remove.add(prev_index)
        else:
            rows_by_attributes[key] = index

    return [row for i, row in enumerate(data) if i not in to_remove]
