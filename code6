import os
import json
from datetime import datetime

def save_data_to_file(data, base_dir='mydir'):
    """
    Saves the given data into a file based on 'tradeDate' and 'user_id'.

    Args:
        data (dict): The data to be saved.
        base_dir (str): The base directory where data will be saved.

    Returns:
        str: The path of the saved file.
    """
    # Extract tradeDate and user_id from the data
    trade_date = data.get('tradeDate')
    user_id = data.get('user_id')
    
    if not trade_date or not user_id:
        raise ValueError("Both 'tradeDate' and 'user_id' must be present in the data.")

    # Convert tradeDate to string if it's a datetime object
    if isinstance(trade_date, datetime):
        trade_date = trade_date.strftime('%Y%m%d')
    
    # Create directory path based on tradeDate
    dir_path = os.path.join(base_dir, trade_date)
    
    # Create the directory if it doesn't exist
    os.makedirs(dir_path, exist_ok=True)

    # Create file path for the specific user
    file_path = os.path.join(dir_path, f"{user_id}.json")

    # Write the data to the file
    with open(file_path, 'w') as f:
        json.dump(data, f, indent=4)
    
    return file_path

# Example usage
data = {
    "tradeDate": "20240813",
    "user_id": "userid1",
    "some_other_data": "example_value"
}

file_path = save_data_to_file(data)
print(f"Data saved to {file_path}")
