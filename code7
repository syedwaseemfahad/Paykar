SELECT t1.A, t1.B, t1.C, t1.D AS max1, t2.D AS max2, t1.E
FROM (
    SELECT A, B, C, D, E,
           ROW_NUMBER() OVER (PARTITION BY A, B, C ORDER BY D DESC) AS row_num
    FROM your_table
) AS t1
JOIN (
    SELECT A, B, C, D,
           ROW_NUMBER() OVER (PARTITION BY A, B, C ORDER BY D DESC) AS row_num
    FROM your_table
) AS t2 ON t1.A = t2.A AND t1.B = t2.B AND t1.C = t2.C AND t1.row_num = 1 AND t2.row_num = 2
WHERE t1.E <> t2.E;
